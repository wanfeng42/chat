# README

## gcc -Wall -g serv_one_to_one.c -o serv -levent -levent_pthreads

## 消息结构（对服务器）：

### 消息中每一个单独的部分都由字节0x02、0x03包围

### LEN为4字节长，存储接下来的全部或部分消息长度

### session的长度由SESSLEN宏定义，一般为16字节

## SIGNUP

### SIGNUP接收

#### (0x02)0(0x03)(0x02)LEN(0x03)(0x02)name(0x03)(0x02)passwd(0x03)  

### SIGNUP发送

#### 出错 (0x02)0(0x03)(0x02)0(0x03)

#### 成功 (0x02)0(0x03)(0x02)1(0x03)

## LOGIN

### LOGIN接收

#### (0x02)1(0x03)(0x02)LEN(0x03)(0x02)name(0x03)(0x02)passwd(0x03)

### LOGIN发送

#### 出错 (0x02)1(0x03)(0x02)0(0x03)

#### 成功 (0x02)1(0x03)(0x02)1(0x03)(0x02)session(0x03)

## TIME

### TIME接收

#### (0x02)2(0x03)(0x02)session(0x03)

### TIME发送

#### 出错 (0x02)2(0x03)(0x02)0(0x03)

#### 成功 (0x02)2(0x03)(0x02)1(0x03)(0x02)LEN(0x03)(0x02)timestring(0x03)

## MESSAGE one to one

### MESSAGE接收

#### (0x02)3(0x03)(0x02)session(0x03)(0x02)LEN(0x03)(0x02)toname(0x03)(0x02)fromname(0x03)(0x02)LEN(0x03)(0x02)message(0x03)

### MESSAGE发送

#### 出错，向发送方 (0x02)3(0x03)(0x02)0(0x03)

#### 出错，向接收方 不发送

#### 成功，向发送方 (0x02)3(0x03)(0x02)1(0x03)

#### 成功，向接收方 (0x02)3(0x03)(0x02)1(0x03)(0x02)LEN(0x03)(0x02)toname(0x03)(0x02)fromname(0x03)(0x02)LEN(0x03)(0x02)message(0x03) 第一个LEN存储直到下一个LEN之间的字节数

## MESSAGE chat room

### 接收

#### (0x02)4(0x03)(0x02)session(0x03)(0x02)LEN(0x03)(0x02)fromname(0x03)(0x02)message(0x03)